title: 将hexo生成的静态网站部署到七牛
comment: true
categories:
  - web
date: 2018-06-13 23:53:38
tags: web
permalink: put-html-to-qiniu

---
最近由于百度的BAE引擎取消了对基础版的支持，所以没有办法，继续寻找可以托管html的服务器。
之前用过gitpages,coding与bae，这几个可以说各有各的特点，也各有各的缺点
gitpages什么都好，就是访问相对慢，coding非要你加一个它们的链接，否则就要在访问网站最开始加个广告
BAE呢，其实BAE基础版挺好的，访问速度快，价钱也合理，没想到他们将要取消了。
在查找新的部署方案时发现有人提到七牛云存储，看了一下他们的文档，可以暂时的满足托管html纯静态网页需求。
开始动工！

<!-- more -->
## 准备
1. 备了案的域名
2. 七牛账户，并且充了10块钱

一、使用hexo生成静态html资源，这个不用多说，使用hexo的都知道
二、登录七牛账号，进入管理控制台，点击`镜像存储`，新建一个存储空间，访问控制一定要选择`公开空间`
三、再点击`绑定域名`,将你网站的域名绑定到刚才创建的空间
![绑定域名](/image/2018/qiniu1.png)
四、将静态网站资源上传到七牛，这里七牛会提供一些工具，windows下有可视化工具，linux与mac下有对应的命令行工具，选自已喜欢的，由于我现在是在windows下操作，所以我使用了可视化工具,下载
https://developer.qiniu.com/kodo/tools/1666/qsunsync
打开这个工具，先点击`账号设置`,输入你的AK与SK,这两个值可以到`个人中心`下的`密钥管理`中获取
![设定AK与SK](/image/2018/qiniu2.png)
AK与SK设置好了以后就可以点击`新建同步任务`
![新建同步任务](/image/2018/qiniu3.png)
本地目录选择hexo生成的public目录，目标空间选择你刚才创建的空间
切换到高级设置，这里一定要设置一下，遇到空间中存在同名文件则强制覆盖，否则之后生成的html如果同名的话就不会上传了
每次同步前检查本地增量文件并上传也要勾上，否则新产生的文件不会上传
![新建同步任务](/image/2018/qiniu4.png)

设置好了以后就可以点击`开始同步`了
上传过程有点慢，要耐心等待。

五、根据七牛的提示，将域名cname到它给你的地址
![设置cname](/image/2018/qiniu5.png)

六、最最关键的一步，空间设置
如果不设置空间，那么你现在的七牛就是一个普通的存储文件的地址，还不能通过域名访问
比如你的首页是 http://www.abc.com/ 如果你现在访问这个，会提示 error: "Document not found"，必须要加上 http://www.abc.com/index.html
七牛现在比较人性化的添加了默认首页展示设定，一定要将其打开
![默认首页展示](/image/2018/qiniu6.png)

这样就可以通过 http://www.abc.com/ 来访问网页了，访问categories等也会自动跳到相应的index.html页面

当cname生效以后就可以正常访问了

更新文章以后，有一个问题，七牛的缓存刷新的很慢，或者说刷新规则里设置的很慢，可以在域名管理处点击绑定的域名然后设置一些缓存规则
![域名设置](/image/2018/qiniu7.png)

点击修改配置
![缓存设置](/image/2018/qiniu8.png)
我将html的更新频率设置为1小时，并且全站缓存设置为1分钟

另外还可以根据自身的需求设置一些防盗链

大功告成，享受一下吧

要时刻关注一下域名的备案信息，如果哪天积案被注销了，七牛也会停止该域名的访问的！！！








